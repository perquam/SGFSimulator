#pragma once

#include <algorithm>
#include <array>
#include <functional>

#define SIZE_X 9
#define SIZE_Y 7
#define SIZE_AIJ_X 6

class RungeKutta5th
{
	double h = 0.0005;

	std::array <double, SIZE_Y> ci
	{ 0.0000000000, 0.2000000000, 0.3000000000, 0.8000000000, 0.8888888888, 1.0000000000, 1.0000000000 };
	std::array <std::array<double, SIZE_Y>, SIZE_AIJ_X> aij
	{ {
		{ 0.0000000000, 0.2000000000, 0.0750000000, 0.9777777777, 2.9525986892, 2.8462752525, 0.0911458333 },
		{ 0.0000000000, 0.0000000000, 0.2250000000, -3.7333333333, -11.5957933241, -10.7575757575, 0.0000000000 },
		{ 0.0000000000, 0.0000000000, 0.0000000000, 3.5555555555, 9.8228928516, 8.9064227177, 0.4492362982 },
		{ 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, -0.2908093278, 0.2784090909, 0.6510416666 },
		{ 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, -0.2735313036, -0.3223761792 },
		{ 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.1309523809 }
	 } };
	std::array <double, SIZE_Y> bi
	{ 0.0911458333, 0.0000000000, 0.4492362982, 0.6510416666, -0.3223761792, 0.1309523809, 0.0000000000 };
	std::array <double, SIZE_Y> bi_prim
	{ 0.0899131944, 0.0000000000, 0.4534890685, 0.6140625000, -0.2715123820, 0.0890476190, 0.0250000000 };
public:
	RungeKutta5th();
	double next_step(std::function<double(double)>, double);
};
